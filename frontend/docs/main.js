(()=>{"use strict";const e=function(e,t,n="GET",i=null){let a={method:n};"PUT"!=n&&"POST"!=n&&null==i||(a.body=JSON.stringify(i),a.headers={"Content-Type":"application/json"}),fetch(e,a).then((e=>e.json())).then((e=>{t(e)})).catch((e=>console.error(e)))};async function t(e,t="GET",n=null,i=null){let a={method:t};"PUT"!=t&&"POST"!=t&&null==n||(a.body=i?n:JSON.stringify(n),a.headers=i||{"Content-Type":"application/json"});try{let t=await fetch(e,a);return await t.json()}catch(e){throw console.error(e),e}}const n="http://wccieducation-001-site3.itempurl.com/data/api",i=`${n}/owner/`,a=`${n}/trip/`,l=`${n}/receipt/`,o=`${n}/vehicle/`,s=`${n}/users/`,d=function(e){return!e||0===e.length},r=function(e){return e.charAt(0).toUpperCase()+e.substr(1).toLowerCase()},c=function(e,t,n){t.forEach((t=>{let i=document.createElement("option");e.appendChild(i);for(let[e,a]of Object.entries(n.attributes))i.setAttribute(e,t[a]);for(let[e,a]of Object.entries(n.properties))i[e]=t[a]}))},u=function(e){return e/1609.34},p=function(e){e=Number(e);var t=Math.floor(e/86400),n=Math.floor(e%86400/3600),i=Math.floor(e%3600/60),a=Math.floor(e%60);return(t>0?t+(1==t?" day, ":" days, "):"")+(n>0?n+(1==n?" hour, ":" hours, "):"")+(i>0?i+(1==i?" minute, ":" minutes, "):"")+(a>0?a+(1==a?" second":" seconds"):"")},m=function(){const e=new Date;return new Date(e.getTime()-6e4*e.getTimezoneOffset()).toISOString().slice(0,-1)};function g(e,t=0){const n=Math.pow(10,5);let i=[],a=0,l=0,o=0;for(;a<e.length;){let s,d=0,r=0;function c(){do{s=e.charCodeAt(a++)-63,r|=(31&s)<<d,d+=5}while(s>=32);const t=r>>1,n=0!=(1&r)?~t:t;return d=r=0,n}l+=c(),o+=c();let u=l/n,p=o/n;5==t?i.push(`is_in(${u},${p});`):i.push({lat:u,lng:p})}return 5==t?i.join("").replace(/,$/,")"):i}function f(e){return e*Math.PI/180}function h(e){return 180*e/Math.PI}const v=6378137;function y(e,t){let n=f(e.lat),i=f(t.lat),a=f(t.lat-e.lat),l=f(t.lng-e.lng),o=Math.sin(a/2)*Math.sin(a/2)+Math.cos(n)*Math.cos(i)*Math.sin(l/2)*Math.sin(l/2),s=2*Math.atan2(Math.sqrt(o),Math.sqrt(1-o));return v*s}function E(e,t){console.log("START GETCOORDINATEATDISTANCE",e,t);let n=e,i=0,a=0,l=1;if(0==n)return t[0];if(n<0||t.length<2)return null;for(;l<t.length&&i<n;)a=i,i+=y(t[l-1],t[l]),l++;if(i<n)return null;console.log("getting Bearing",t[l-2],t[l-1]);let o=t[l-2],s=n-a,d=function(e,t){console.log(e,t);let n=f(e.lat),i=f(t.lat),a=f(t.lng)-f(t.lng),l=Math.sin(a)*Math.cos(i),o=Math.cos(n)*Math.sin(i)-Math.sin(n)*Math.cos(i)*Math.cos(a);return h(Math.atan2(l,o))%360}(o,t[l-1]);return function(e,t,n){let i=f(e.lat),a=f(e.lng),l=n/v,o=Math.asin(Math.sin(i)*Math.cos(l)+Math.cos(i)*Math.sin(l)*Math.cos(t)),s=a+Math.atan2(Math.sin(t)*Math.sin(l)*Math.cos(i),Math.cos(l)-Math.sin(i)*Math.sin(i));return{lat:h(o),lng:h(s)}}(o,d,s)}const b=3.78541,I=1609.34;class T{#e=0;constructor(e=1,t=1,n=30,i=12,a=1,l=null){this.ownerId=e,this.vehicleId=t,this.fuelEfficiency=n,this.fuelCapacity=i,this.#e=a,this.target=l,this.render()}render(){this.target&&(this.target.innerHTML=`\n            <div class="result-item">\n                <h3>Fuel Efficiency: <strong id="fuel-efficiency">${this.fuelEfficiency} m.p.g.</strong></h3>\n                <h3>Fuel Capacity: <strong id="fuel-capacity">${this.fuelCapacity.toFixed(2)} gal.</strong></h3>\n                <h3>Current Fuel: <strong id="current-fuel">${this.fuel.toFixed(2)} gal.</strong></h3>\n                <h3>Max Distance: <strong id="max-distance">${this.maxDistance.toFixed(2)} mi.</strong></h3>\n            </div>\n            `)}get gaugeReading(){return this.#e}set gaugeReading(e){this.#e=e,this.render()}get fuelTankSizeInLiters(){return this.fuelCapacity*b}get fuel(){return this.fuelCapacity*this.#e}get fuelInLiters(){return this.fuel*b}get maxDistance(){return this.fuel*this.fuelEfficiency}get maxDistanceInMeters(){return this.maxDistance*I}get maxDistanceOnFull(){return this.fuelCapacity*this.fuelEfficiency}get maxDistanceOnFullInMeters(){return this.fuelCapacity*this.fuelEfficiency*I}get maxDistanceOnEmpty(){return 2*this.fuelEfficiency}get maxDistanceOnEmptyInMeters(){return this.maxDistanceOnEmpty*I}getRefuelDistances(e){let t=[],n=e,i=this.maxDistanceInMeters;for(;i<n;)n-=i,t.push({distance:i,fuel:this.fuel}),this.gaugeReading=1,i=this.maxDistanceInMeters;return 0!=n&&(this.gaugeReading=n/i,t.push({distance:n,fuel:this.fuel})),this.gaugeReading=0,t}refuel(){this.#e=1}}const $={DisplayAll:B,GetReceipts:function(t){e(l+t,B)},AddReceiptView:function(t){k.innerHTML=`\n\n        <section class="Input"> \n        <div class="Login">\n            <h2>Enter Receipt Info</h2>\n        </div>\n        <div id="loginpage">\n        <input type="hidden" id="tripId" value="${t}" />\n        <label for="PricePerGallon">PricePerGallon</label>\n        <input type="text" id="PricePerGallon">\n        <label for="TotalCost">TotalCost</label>\n        <input type="text" id="TotalCost">\n        <label for="GasStation">GasStation</label>\n        <input type="text" id="GasStation">\n        </div>\n\n        <button type="submit" id="createNewReceiptBtn">Save</button>\n\n        </section>\n    `,document.getElementById("createNewReceiptBtn").addEventListener("click",(function(){let t=document.getElementById("PricePerGallon").value,n=document.getElementById("TotalCost").value,i=document.getElementById("GasStation").value,a=document.getElementById("tripId").value;if(!(d(t)||d(n)||d(i)||d(a))){let o={PricePerGallon:t,TotalCost:n,AdditionalCosts:0,GasStation:r(i),TripId:a};console.log(),e(l,w,"POST",o)}}))},DeleteAReceipt:M,SetupForButtons:D,UpdateReceiptView:C,GetReceipt:function(t){console.log("getReceipt"),e(l+t,D)}},k=document.getElementById("app");function B(e){return null==e&&(e=[]),`\n    <ul>\n        ${e.map((e=>`<li>Date and Time: ${e.date}</li>\n                    <li>City the gas station is located in: ${e.gasStation}</li>\n                    <li>Gas price by the gallon: $${e.pricePerGallon} per gallon</li>\n                    <li>Total Cost of the trip: $${e.totalCost} dollars</li>\n                    <section id="${e.id}" class="receipts">\n                        <button class="DeleteReceipt"> Delete Receipt</button>\n                        <button class="EditReceipt">Edit Receipt</button>\n                    </section>\n                \n            `)).join("")}\n    </ul>\n    `}function D(e){let t=document.getElementsByClassName("receipts");Array.prototype.forEach.call(t,(function(t){console.log(t);let n=t.id,i=t.getElementsByClassName("DeleteReceipt")[0],a=t.getElementsByClassName("EditReceipt")[0];i.addEventListener("click",(function(){console.log(t),M(n)})),a.addEventListener("click",(function(){console.log("edit click"),console.log(e[e.length-1]),C(e[e.length-1])}))}))}function w(e){console.log(e),k.innerHTML=`\n        <p>Date and Time: ${e.date}</p>\n        <p>City the gas station is located in: ${e.gasStation}</p>\n        <p>Gas price by the gallon: $${e.pricePerGallon} per gallon</p>\n        <p>Total Cost of the trip: $${e.totalCost} dollars</p>\n    \n        \n    `}function M(t){console.log(t),e(l+t,O.TripView,"DELETE")}function C(t){console.log("h"),console.log(t.Trip),k.innerHTML=`\n    <h2>Edit Receipt</h2>\n\n\n    <input type="hidden" id="TripId" name="TripId" value="${t.tripId}">\n    \n\n    <label for="PricePerGallon">Price of gas per gallon</label>\n    <input type="text" id="PricePerGallon" value="${t.pricePerGallon}">\n\n    <label for="TotalCost">Total cost of trip</label>\n    <input type="text" id="TotalCost" value="${t.totalCost}">\n\n    <label for="GasStation">Gas Station</label>\n    <input type="text" id="GasStation" value="${t.gasStation}">\n\n    <button type="submit" id="saveUpdateReceiptbtn">Update</button>\n    \n    `,function(t){const n=document.getElementById("saveUpdateReceiptbtn");console.log("ffffff"),n.addEventListener("click",(function(){!function(t,n){let i={PricePerGallon:document.getElementById("PricePerGallon").value,TotalCost:document.getElementById("TotalCost").value,GasStation:document.getElementById("GasStation").value,TripId:document.getElementById("TripId").value,ownerId:1};i.Id=t,console.log(i),e(l+t,w,"PUT",i)}(t.id)}))}(t)}const L=function(e,t){Array.prototype.forEach.call(["January","February","March","April","May","June","July","August","September","October","November","December"],(function(n,i){const a=document.createElement("option");a.textContent=n,a.value=i+1<10?`0${(i+1).toString()}`:(i+1).toString(),e.appendChild(a),a.value===t&&(a.selected=!0),console.log(e)}))},x=function(e,t){let n=(new Date).getFullYear();for(let i=n-20;i<n+20;i++){const n=document.createElement("option");n.textContent=i,n.value=i,i===t&&(n.selected=!0),e.appendChild(n)}},P=function(e,t,n,i){let a;i.innerHTML="",a="02"===n?t%4==0&&t%100!=0||t%400==0?29:28:"01"===n||"03"===n||"05"===n||"07"===n||"08"===n||"10"===n||"12"===n?31:30;for(let t=1;t<=a;t++){const n=document.createElement("option");t<10&&(t=`0${t.toString()}`),n.textContent=t,n.value=t,i.appendChild(n),t===e&&(n.selected=!0)}},S=function(e,t){for(let n=1;n<=24;n++){const i=document.createElement("option");n<10&&(n=`0${n.toString()}`),i.textContent=n,i.value=n,e.appendChild(i),n===t&&(i.selected=!0)}},A=function(e,t){for(let n=0;n<60;n++){const i=document.createElement("option");n<10&&(n=`0${n.toString()}`),i.textContent=n,i.value=n,e.appendChild(i),n===t&&(i.selected=!0)}},U=function(e){let t=new Date(e);console.log(t);let n=t.toDateString().split(" "),i=`${n[0]},${n[1]} ${n[2]},${n[3]}`,a=t.getMinutes()<10?`0${t.getMinutes()}`:t.getMinutes();return i+` ${12==t.getHours()?`12:${a}PM`:24==t.getHours()?`12:${a}AM`:t.getHours()<12?`${t.getHours()}:${a}AM`:`${t.getHours()-12}:${a}PM`}`},O={GetTrips:function(t){e(a+`?ownerId=${t}`,F)},TripView:R},G=document.getElementById("app");function F(t){console.log(t),G.innerHTML=`\n    <div class="tripsView">    \n        \n\n        <section class="trips-container">\n            ${t.map((e=>`\n                <ul id="${e.id}" class="trips">                   \n                    <li class="trip">${e.startAddress} to ${e.endAddress}</li>\n                    <li class="trip">${U(e.embarkDate)} ${null==e.disembarkDate?" ":" to "+U(e.disembarkDate)}</li>\n                    <li>${e.receipts.length} Receipts</li>\n                    <button class="createNewReceiptBtn">Add Receipt</button>  \n                    <button class="deleteTripBtn">Delete</button> \n                    \n                </ul>        \n                `)).join("")}  \n        </section> \n    </div>\n    `,function(){const t=document.getElementsByClassName("trips");Array.from(t).forEach((t=>{let n=t.getElementsByClassName("trip")[0],i=t.getElementsByClassName("deleteTripBtn")[0],l=t.getElementsByClassName("createNewReceiptBtn")[0],o=t.id;console.log(o),n.addEventListener("click",(function(){!function(t){e(a+t,R)}(o)})),i.addEventListener("click",(function(){!function(t){e(a+t,F,"DELETE")}(o)})),l.addEventListener("click",(function(){console.log("add clicked"),function(t){let n=q.GetId();e(a+`?ownerId=${n}`,(()=>{$.AddReceiptView(t)}))}(o)}))}))}()}function R(t){G.innerHTML=`\n        <div class="singletripView">\n            <div class="location">\n                <p>From ${t.startAddress} to ${t.endAddress}</p>\n                <button id="updateTripBtn">Update Trip</button>\n            </div>\n            <div class="tripInfo">\n                \n                  \n                    <p>${U(t.embarkDate)} ${null==t.disembarkDate?" ":" to "+U(t.disembarkDate)}</p>\n                    <p>MileageBefore: ${t.mileageBefore}</p>\n                    <p>MileageAfter: ${t.mileageAfter} </p>\n                    <p>Distance ${t.distance} </p>\n                    <p>EstimatedGasCost ${t.estimatedGasCost} </p>\n             \n            </div>\n            <div class="receiptsView"> \n                <h3>Receipts</h3>\n            ${$.DisplayAll(t.receipts)}  \n            </div>      \n        </div>  \n    `,function(t){document.getElementById("updateTripBtn").addEventListener("click",(function(){!function(t){console.log("updating"),G.innerHTML=`\n    <div class="EditTripLayout">\n        <h2>Edit trip from ${t.startAddress} to ${t.endAddress}</h2>\n\n        <section class="Input">\n        <div class="trip-input">\n        <label for="embarkDate">Embark Date</label>\n        <select id="monthOptions"></select>\n        <select id="dateOptions"></select>\n        <select id="yearOptions"></select>\n        <select id="hourOptions"></select>\n        <select id="minOptions"></select>\n        </div>\n\n        <div class="trip-input">\n        <label for="disembarkDate">Disembark Date</label>\n        <input type="text" id="disembarkDate" value="${null==t.disembarkDate?"":new Date(t.embarkDate).getDate()}" placeholder="${null==t.disembarkDate?"":new Date(t.embarkDate).getDate()}">\n        </div>\n        <div class="trip-input">\n        <label for="startAddress">StartAddress</label>\n        <input type="text" id="startAddress" value="${t.startAddress}" placeholder="${t.startAddress}">\n        </div>\n        <div class="trip-input">\n        <label for="endAddress">EndAddress</label>\n        <input type="text" id="endAddress" value="${t.endAddress}" placeholder="${t.endAddress}">\n        </div>\n        <div class="trip-input">\n        <label for="mileageBefore">MileageBefore</label>\n        <input type="text" id="mileageBefore" value="${t.mileageBefore}" placeholder="${t.mileageBefore}">\n        </div>\n        <div class="trip-input">\n        <label for="mileageAfter">MileageAfter</label>\n        <input type="text" id="mileageAfter" value="${t.mileageAfter}" placeholder="${t.mileageAfter}">\n        </div>\n        <div class="trip-input">\n        <span id="error" hidden>A number is needed here!</span>\n        <label for="eTA">ETA</label>\n        <input type="text" id="eTA" value="${null==t.arrivalDate?"":t.arrivalDate}" placeholder="${null==t.arrivalDate?"":t.arrivalDate}">\n        </div>\n        <div class="trip-input">\n        <label for="distance">Distance</label>\n        <input type="text" id="distance" value="${t.distance}" placeholder="${t.distance}">\n        </div>\n        <div class="trip-input">\n        <label for="estimatedGasCost">EstimatedGasCost</label>\n        <input type="text" id="estimatedGasCost" value="${t.estimatedGasCost}" placeholder="${t.estimatedGasCost}">\n        </div>\n        <div class="trip-input">\n        <label for="estimatedTotalCost">EstimatedTotalCost</label>\n        <input type="text" id="estimatedTotalCost" value="${t.estimatedTotalCost}" placeholder="${t.estimatedTotalCost}">\n\n        <input id="vehicle" value="${t.vehicleId}" hidden>\n        </div>\n        <div class="trip-input">\n        <button type="submit" id="saveUpdateTripBtn">Save</button> \n        </div>\n        </section>\n    </div>\n    `;let n=new Date(t.embarkDate).getFullYear(),i=new Date(t.embarkDate).getMonth()+1<10?`0${new Date(t.embarkDate).getMonth()+1}`:new Date(t.embarkDate).getMonth()+1,l=new Date(t.embarkDate).getDate()<10?`0${new Date(t.embarkDate).getDate()}`:new Date(t.embarkDate).getDate(),o=new Date(t.embarkDate).getHours()<10?`0${new Date(t.embarkDate).getHours()}`:new Date(t.embarkDate).getHours();console.log(`controller hour ${o}`);let s=new Date(t.embarkDate).getMinutes()<10?`0${new Date(t.embarkDate).getMinutes()}`:new Date(t.embarkDate).getMinutes();console.log(`controller min ${s}`);const d=document.getElementById("monthOptions"),r=document.getElementById("yearOptions"),c=document.getElementById("dateOptions"),u=document.getElementById("hourOptions"),p=document.getElementById("minOptions");var m;L(d,i),x(r,n),S(u,o),A(p,s),P(l,n,i,c),function(){const e=document.getElementById("monthOptions"),t=document.getElementById("yearOptions"),n=document.getElementById("dateOptions");e.addEventListener("focusout",(function(){let i=e.value,a=t.value;P(100,a,i,n)})),t.addEventListener("focusout",(function(){let i=e.value,a=t.value;P(100,a,i,n)}))}(),m=t.id,document.getElementById("saveUpdateTripBtn").addEventListener("click",(function(){!function(t){const n=document.getElementById("monthOptions").value;let i=`${document.getElementById("yearOptions").value}-${n}-${document.getElementById("dateOptions").value}T${document.getElementById("hourOptions").value}:${document.getElementById("minOptions").value}:00.0000000`;document.getElementById("error");let l=document.getElementById("startAddress").value,o=document.getElementById("endAddress").value,s=document.getElementById("mileageBefore").value,d=document.getElementById("mileageAfter").value,r=document.getElementById("eTA").value,c=document.getElementById("distance").value,u=document.getElementById("estimatedGasCost").value,p=document.getElementById("estimatedTotalCost").value,m=document.getElementById("vehicle").value,g=[l,o,s,d,r,c,u,p],f=0;for(let e=0;e<g.length;e++)null==g[e]&&f++;if(0==f){let n={EmbarkDate:i,StartAddress:l,EndAddress:o,MileageBefore:s,MileageAfter:d,Distance:c,EstimatedGasCost:u,EstimatedTotalCost:p,VehicleId:m,Id:t};console.log(n),e(a+t,R,"PUT",n)}}(m)}))}(t)}))}(t),$.SetupForButtons(t.receipts)}const N=function(t){e(`${o}?ownerId=${t}`,j)},H=document.getElementById("app");function V(t){e(o+t,_)}function j(t){let n=document.createElement("div"),i=document.createElement("div");i.classList.add("addVehicleButtonDiv");let a=document.createElement("button");a.classList.add("addVehicleButton"),a.innerHTML="Add Vehicle",a.id="Add-Vehicle-button",i.appendChild(a),n.appendChild(i);for(let e=0;e<t.length;e++){let i=document.createElement("div");i.classList.add("vehicleView");let a=document.createElement("p");a.setAttribute("id",e);let l=document.createElement("button");l.innerText="Delete",l.setAttribute("id","DeleteVehicleBtn"+e),a.innerHTML=t[e].year+" "+t[e].make+"  "+t[e].model,i.appendChild(a),i.appendChild(l),n.appendChild(i)}H.innerHTML=n.innerHTML,document.getElementById("Add-Vehicle-button").addEventListener("click",(function(){console.log("works"),Y()}));for(let n=0;n<t.length;n++){let i=document.getElementById(n),a=document.getElementById("DeleteVehicleBtn"+n);i.addEventListener("click",(function(){console.log("vehicleView was click"),V(n+1)})),a.addEventListener("click",(function(){var i;console.log("Delete was click"),console.log(t[n].id),i=t[n].id,console.log(o),e(o+i,j,"DELETE")}))}}function _(t){var n;H.innerHTML=`\n    <div class="vehiclelist">\n    <p>Make: ${t.make}</p>\n    <p>Model: ${t.model}</p>\n    <p>Year: ${t.year}</p>\n    <p>Fuel Efficiency: ${t.fuelEfficiency}</p>\n    <p>Size of fuel tank: ${t.fuelTank} gallons</p>\n    \n    <button id='UpdateVehicleBtn'>Update Vehicle</button>\n    </div>\n    `,n=t.id,document.getElementById("UpdateVehicleBtn").addEventListener("click",(function(){e(o+n,z)}))}function z(e){H.innerHTML=`\n    <div id="add-vehicle-container">\n    <div class="add-vehicle-op">\n        <h2>Edit Vehicle</h2>\n    </div>\n    <div class="add-vehicle-op">\n        <input type="text" id="Make" value="${e.make}" placeholder="${e.make}">\n    </div>\n\n    <div class="add-vehicle-op">\n    <input type="text" id="Model" value="${e.model}" placeholder="${e.model}">\n    </div>\n    <div class="add-vehicle-op">\n    <input type="text" id="Year" value="${e.year}" placeholder="${e.year}">\n    </div>\n    <div class="add-vehicle-op">\n    <input type="text" id="FuelEfficiency" value="${e.fuelEfficiency}" placeholder="${e.fuelEfficiency}">\n    </div>\n    <div class="add-vehicle-op">\n    <input type="text" id="FuelTank" value="${e.fuelTank}" placeholder="${e.fuelTank}">\n    </div>\n    <div class="add-vehicle-op">\n    <button type="submit" id="saveUpdateVehicleBtn">Update</button> \n    </div>\n    </div> \n    `,function(e){document.getElementById("saveUpdateVehicleBtn").addEventListener("click",(function(){J(e.id,"PUT")}))}(e)}function Y(){let e=null,t="";fetch("https://parseapi.back4app.com/classes/Carmodels_Car_Model_List",{headers:{"X-Parse-Application-Id":"iqVulf4rcnwk8v3YC71FGKNkUrY7mzNJosyQzpUA","X-Parse-REST-API-Key":"ugWIeOKk3FQoATqdZaR7Gv4jTsc2tsFzLjDNST5a"}}).then((e=>e.json())).then((n=>{console.log(n),console.log(n.results),console.log(n.results.length);for(let i=0;i<n.results.length;i++)console.log("makeList"),console.log(n.results[i].Make),t+=`<option value='${n.results[i].Model}'>${n.results[i].Model}</option>`,e+=`<option value='${n.results[i].Make}'>${n.results[i].Make}</option>`;H.innerHTML=`\n    <div id="add-vehicle-container">\n    <div class="add-vehicle-op">\n    <h2>Add New Vehicle</h2>\n    </div>\n    <div class="add-vehicle-op">\n    <select class="MakeOptions" id="Make">\n    <option selected disabled>--Select Vehicle Make--</option>\n    ${e}\n    </select>\n    </div>\n    \n    <div class="add-vehicle-op">\n    <select class="ModelOptions" id="Model">\n    <option selected disabled>--Select Vehicle Model--</option>\n    ${t}\n    </select> \n    </div>\n    \n    <div class="add-vehicle-op">\n    <input type="number" id="Year" placeholder="Year" />\n    </div>\n\n    <div class="add-vehicle-op">\n    <input type="number" id="FuelEfficiency" placeholder="Fuel Efficiency (m.p.g.)" />\n    </div>\n\n    <div class="add-vehicle-op">\n    <input type="number" id="FuelTank" placeholder="Fuel Capacity (gal.)" />\n    </div>\n    <div class="add-vehicle-op">\n    <button type="submit" id="createNewVehicleBtn">Submit</button>\n    </div>\n    </div>\n`;var i=document.getElementById("Make");[].slice.call(i.options).map((function(e){this[e.value]?i.removeChild(e):this[e.value]=1}),{}),console.log("eventListener"),document.getElementById("createNewVehicleBtn").addEventListener("click",(function(){J("","POST")}))})).catch((e=>console.log(e)))}function J(t,n){let i={Make:document.getElementById("Make").value,Model:document.getElementById("Model").value,Year:document.getElementById("Year").value,FuelEfficiency:document.getElementById("FuelEfficiency").value,FuelTank:document.getElementById("FuelTank").value,ownerId:q.GetId()};"PUT"==n&&(i.Id=t),console.log(i),e(o+t,_,n,i)}const W={getCookie:function(e){var t=document.cookie.match("(^|;) ?"+e+"=([^;]*)(;|$)");return t?t[2]:null},setCookie:K,deleteCookie:function(e){K(e,"",-1)}};function K(e,t,n){var i=new Date;i.setTime(i.getTime()+864e5*n),document.cookie=e+"="+t+";path=/;expires="+i.toGMTString()}const q={GetProfile:function(t){e(i+t,X)},AddOwnerView:function(e){Q.innerHTML=`\n        <section class="Input">\n            <h2>Create Your Profile</h2>\n\n            <input type="hidden" id="UserId" name="UserId" value="${e.id}">\n\n            <label for="firstName">First Name</label>\n            <input type="text" id="firstName">\n            <label for="lastName">Last Name</label>\n            <input type="text" id="lastName">\n\n            <button type="submit" id="createNewProfileBtn">Save</button>\n        </section>\n    `,ee()},SetupForSubmitProfile:ee,GetId:ne,isLoggedIn:function(){return null!=W.getCookie("UserId")}},Q=document.getElementById("app");function X(t){var n;console.log(t),Q.innerHTML=`\n      \n        <section class="profile">\n         <div class="OwnerName">\n             <h2>Hello, ${t.fullName}</h2>\n         </div>    \n        \n         <p id="myVehicles">My Vehicles</p>\n         <p id="myTrips">My Trips</p>\n        \n         <p id="updateProfileBtn">Update Profile</p>\n        </section>\n    `,function(){const e=document.getElementById("myVehicles"),t=document.getElementById("myTrips");let n=ne();e.addEventListener("click",(function(){N(n)})),t.addEventListener("click",(function(){O.GetTrips(n)}))}(),n=t.id,document.getElementById("updateProfileBtn").addEventListener("click",(function(){e(i+n,te)}))}function Z(t,n){let a=document.getElementById("firstName").value,l=document.getElementById("lastName").value,o=document.getElementById("UserId").value;if(!d(a)&&!d(l)){a=r(a.trim()),l=r(l.trim());let s={FirstName:a,LastName:l,UserId:o};"PUT"==n&&(s.Id=t),console.log(s),e(i+t,X,n,s)}}function ee(){document.getElementById("createNewProfileBtn").addEventListener("click",(function(){Z("","POST")}))}function te(e){Q.innerHTML=`\n\n    <section class="Input">\n    <div class="Login">\n        <h2>Edit Your Profile</h2>\n    </div>\n    <div id="loginpage">\n        <input type="hidden" id="UserId" value="${ne()}">\n\n        <label for="firstName">First Name</label>\n        <input type="text" id="firstName" value="${e.firstName}" placeholder="${e.firstName}">\n        <label for="lastName">Last Name</label>\n        <input type="text" id="lastName" value="${e.lastName}" placeholder="${e.lastName}">\n    </div>\n        <button type="submit" id="saveUpdateProfileBtn">Save</button>\n    </section>\n    `,function(e){document.getElementById("saveUpdateProfileBtn").addEventListener("click",(function(){Z(e.id,"PUT")}))}(e)}function ne(){return W.getCookie("UserId")}const ie=function(){document.getElementById(le),le.innerHTML=`\n        <div id="create-trip-container" style="min-height:100vh; display:flex">\n            <google-map id="map" style="order: 2"></google-map>\n            <div id="sidebar" style="order: 1; flex-basis: 15rem;flex-grow: 1;padding: 1rem;max-width: 30rem;height: 100%;box-sizing: border-box;overflow: auto;flex-direction: column;">\n                <div class="trip-input">\n                    <select id="vehicle-select">\n                        <option selected disabled>---SELECT VEHICLE---</option>\n                    </select>\n                </div>\n                <div class="trip-input">\n                    <label for="departure-dt">Departure Date<label>\n                    <input type="datetime-local" id="departure-dt" min="${m()}" value="${m()}" />\n                </div>\n                <div class="trip-input">\n                    <label for="round-trip">Round Trip</label>\n                    <input id="round-trip" type="checkbox" />\n                </div>\n                <div class="trip-input">\n                    <label for="disembarkment-dt">Disembarment Date<label>\n                    <input type="datetime-local" id="disembarkment-dt" disabled min="${m()}" value="${m()}"/>\n                </div>\n                <div class="trip-input">\n                    <input id="origin" type="text" placeholder="Enter Origin Address" />\n                </div>\n                <div class="trip-input">\n                    <input id="destination" type="text" placeholder="Enter Destination Address"/>\n                </div>\n                <div class="trip-input">\n                    <input placeholder="Enter Odometer Mileage" type="text" id="odometer-reading" />\n                </div>\n                <div class="trip-input">\n                    <label for="fuel-gauge-reading">Initial Fuel Gauge Reading: <strong id="fuel-gauge-percentage">100%</strong></label>\n                </div>\n                <div class="trip-input"> \n                    <input id="fuel-gauge-reading" type="range" min="0.0" max="1.0" step="0.1" value="1.0" />\n                </div>\n                <div class="trip-input">\n                    <button id="submit-button">Submit</button>\n                    <button id="save-button" disabled>Save</button>\n                </div>\n                <div id="car-details"></div>\n                <div id="trip-embarkment-details"></div>\n                <div id="trip-disembarkment-details"></div>\n                <div id="trip-totals-details"></div>\n            </div>\n        </div>\n    `,function(){const e=document.getElementById("origin"),n=document.getElementById("destination"),i=document.getElementById("submit-button"),a=document.getElementById("map"),l=document.getElementById("vehicle-select");!async function(e){let n=q.GetId(),i=await t(`${o}?ownerId=${n}`);c(e,i,{attributes:{"data-id":"id",value:"id"},properties:{text:"yearMakeModel"}})}(l);const s=document.getElementById("car-details"),d=document.getElementById("fuel-gauge-reading"),r=document.getElementById("fuel-gauge-percentage"),u=document.getElementById("departure-dt"),p=document.getElementById("round-trip"),m=document.getElementById("disembarkment-dt");p.addEventListener("change",(function(){p.checked?m.disabled=!1:m.disabled=!0}));let g=null;l.addEventListener("change",(function(){(async function(e,n=1,i=null){let a=await t(`${o}${e}`);return console.log("GOT VEHICLE MODEL",a),new T(a.ownerId,a.id,a.fuelEfficiency,a.fuelTank,n,i)})(l.value,parseFloat(d.value),s).then((e=>{g=e,g.render(),console.log("VEHICLE SELECTED",g)}))})),d.addEventListener("change",(function(){g&&(g.gaugeReading=d),r.innerText=100*d.value+"%"}));const f=document.getElementById("odometer-reading");i.addEventListener("click",(function(){let t={origin:e.value,destination:n.value,travelMode:"DRIVING",unitSystem:1,avoidHighways:!1,avoidTolls:!1};const i=p.checked?new Date(m.value):null;console.log("SUBMIT VEHICLE:",g),ae(g,t,a,new Date(u.value),f.value,d.value,p.checked,i)}))}()};async function ae(e,n,i,l,o,s=1,d=!1,r=null,c=!1){const m=new google.maps.InfoWindow({pixelOffset:new google.maps.Size(0,-40)});c&&e.refuel();let f=await i.directionsService.route(n);const h=new google.maps.DirectionsRenderer;h.setMap(i.map),h.setOptions({suppressMarkers:c,polylineOptions:{zIndex:c?4:5,strokeColor:c?"#00FF00":"#0000FF",strokeWeight:5,strokeOpacity:.5}}),h.setDirections(f);let v=g(f.routes[0].overview_polyline,5);c||async function(e){let n=`data=${encodeURIComponent(`[out:json];(${e})->.a;rel(pivot.a)[boundary=administrative][admin_level=6];out geom;`)}`;return await t("https://overpass-api.de/api/interpreter","POST",n,{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"})}(v).then((e=>{let t=osmtogeojson(e);const n=[];t.features.forEach((e=>{if("Polygon"==e.geometry.type){e.style={};const t=e.properties.wikipedia.match(/en:([a-z\s]+),\s([a-z\s]+)$/i),i=t[1].replace(/\scounty/i,""),a=t[2],l=gasPrices[a][i];e.properties.countyPrice=`${i} County, ${a}<br /> Avg. Gas Price: ${l}`,e.properties.fill=countyColors[a][i],n.push(e)}})),t.features=n;const a=URL.createObjectURL(new Blob([(new TextEncoder).encode(JSON.stringify(t))],{type:"application/json; charset='application/json;charset=utf8'"}));i.map.data.loadGeoJson(a),i.map.data.setStyle((function(e){return{fillColor:e.getProperty("fill"),fillOpacity:.25,zIndex:1,strokeColor:"green",strokeOpacity:.5,strokeWeight:1}})),i.map.data.addListener("mouseover",(function(e){m.setContent(`\n                        <div style="font-size:2em">\n                            ${e.feature.getProperty("countyPrice")}\n                        </div>\n                    `),m.open(i.map)})),i.map.data.addListener("mouseout",(function(e){m.close()})),i.map.data.addListener("mousemove",(function(e){m.setPosition(e.latLng)}))}));let y=f.routes[0].legs,b=y.map((e=>e.distance.value)).reduce(((e,t)=>e+t)),I=e.getRefuelDistances(b),T=I.map((e=>e.distance)),$=I.map((e=>e.fuel)),k=y.flatMap((e=>e.steps)),B=function(e,t){if(console.log(e,t),t.length<1)return[];let n=0,i=0,a=0,l=0,o=[],s=null,d=0;for(let r=0;r<t.length;r++){for(;d<e.length&&n<t[r];)s=e[d],i=n,l=a,n+=e[d].distance.value,a+=e[d].duration.value,d++;let c=t[r]-i,u=l*(t[r]/c);o.push({stepIndex:d-1,distanceRemaining:c,eta:u}),n=0,i=0,a=0,l=0}return console.log(o),o}(k,T),D=B.map((e=>k[e.stepIndex])),w=function(e,t){let n=[];if(e.length!=t.length)throw Error("there must be the same number of distances and paths");for(let i=0;i<t.length;i++)n.push(E(e[i],t[i]));return n}(B.map((e=>e.distanceRemaining)),D.map((e=>e.polyline.points)).map((e=>g(e)))),M=y[0].start_location,C=y.map((e=>e.duration.value)).reduce(((e,t)=>e+t)),L=new Date(l);L=L.setSeconds(L.getSeconds()+C);let x=w.filter((e=>null!=e));i.addMarkers(x,{icon:c?"./images/green_markerF.png":"./images/blue_MarkerF.png"});const P=await i.reverseGeocodeAll([M,...x]);let S=[];for(let e=0;e<T.length;e++){const t=P[e],n=$[e],i=T[e],a=t[t.length-3].address_components,l=a[0].long_name.replace(/\scounty/i,"").trim(),o=a[1].long_name.trim(),s=parseFloat(gasPrices[o][l].replace("$",""));S.push({fuelUsage:n,distance:i,county:l,state:o,gasPrice:s,gasCost:s*n})}const A={fuelUsage:S.map((e=>e.fuelUsage)).reduce(((e,t)=>e+t)),distance:S.map((e=>e.distance)).reduce(((e,t)=>e+t)),fuelCost:S.map((e=>e.gasCost)).reduce(((e,t)=>e+t))},U=c?"trip-disembarkment-details":"trip-embarkment-details";document.getElementById(U).innerHTML=`\n    <div class="result-item">\n        <h2>${c?"Disembarkment Details":"Embarkment Details"}</h2>\n        <h3>Fuel Stops:</h3>\n        <ol>\n            ${S.map((e=>`\n                    <li>\n                        <h4>Distance: ${u(e.distance).toFixed(2)} mi. - Fuel Usage: ${e.fuelUsage.toFixed(2)}</h4>\n                        <h4>Fuel Price: <strong>$${e.gasPrice.toFixed(2)}</strong>(${e.county} County, ${e.state})</h4>\n                        <h4>Fuel Cost: <strong>$${e.gasCost.toFixed(2)}</strong></h4>\n                    </li>\n                `)).join("")}\n        </ol>\n        <h3>Total Distance: <strong>${u(A.distance).toFixed(2)} mi.</strong></h3>\n        <h3>Total Fuel Usage: <strong>${A.fuelUsage.toFixed(2)} gal.</strong></h3>\n        <h3>Total Fuel Cost: <strong>$${A.fuelCost.toFixed(2)}</strong></h3>\n        <h3>Total Trip Duration: <strong>${p(C)}</strong></h3>\n        </div>\n    `;const G={startAddress:y[0].start_address,endAddress:y[y.length-1].end_address,mileageBefore:o,embarkDate:l,arrivalDate:L,distance:u(b),estimatedGasCost:A.fuelCost,estimatedFuelUsage:A.fuelUsage,vehicleId:e.id,disembarkDate:r,returnDate:null};let F=Object.assign({},G);if(d){let t=Object.assign({},n);t.origin=n.destination,t.destination=n.origin;const a=await ae(e,t,i,r,G.mileageAfter,e.gaugeReading,!1,null,!0);F.estimatedGasCost+=a.estimatedGasCost,F.estimatedFuelUsage+=a.estimatedFuelUsage,F.returnDate=a.arrivalDate,F.distance+=a.distance}if(F.arrivalDate=new Date(F.arrivalDate).toISOString(),F.embarkDate=new Date(F.embarkDate).toISOString(),F.returnDate=F.returnDate?new Date(F.returnDate).toISOString():null,F.disembarkDate=F.disembarkDate?new Date(F.disembarkDate).toISOString():null,0!=c)return G;{document.getElementById("trip-totals-details").innerHTML=`\n        <div class="result-item">\n        <h2>Round Trip Totals</h2>\n        <h3>Total Distance: <strong>${F.distance.toFixed(2)} mi.</strong></h3>\n        <h3>Total Fuel Usage: <strong>${F.estimatedFuelUsage.toFixed(2)} gal.</strong></h3>\n        <h3>Total Fuel Cost: <strong>$${F.estimatedGasCost.toFixed(2)}</strong></h3>\n        </div>\n        `;const e=document.getElementById("save-button");e.disabled=!1,e.addEventListener("click",(function(){F.vehicleId=document.getElementById("vehicle-select").value,t(a,"POST",F).then((e=>{O.TripView(e)}))}))}}const le=document.getElementById("app"),oe=function(){se.innerHTML='\n        <div class="AboutUs">\n            <div class="TopPart">\n                <h2>Inspiration for our project</h2>\n\n                <div class="aboutus-info">\n                    <p>Recently gas prices have risen to unseen highs which can affect our travel experience.</p>\n\n                    <p>With our app you can easily plan: </p>\n                    <ul>\n                        <li>-Where and when this trip takes place.</li>\n                        <li>-How much gas would be needed.</li>\n                        <li>-The total cost of the gas needed for the trip.</li>\n                        <li>-How many miles will be driven.</li>\n                        <li>-And record the details including receipts of the trip.</li>\n                        <li>-And record of vehicle condition.</li>\n                    </ul>\n                </div>\n            </div>    \n        <div class="BottomPart">\n                <div class="BottomLeft">    \n                    \n                    <h3>Connect with us:</h3>\n                    <section class="Links">\n                        <a href="https://github.com/BradRWeir" target="_blank">Brad\'s Github</a> \n                        <a href="https://github.com/DenzaleM" target="_blank"> Denzale\'s Github</a> \n                        <a href="http://github.com/adia1bug"target="_blank" >Qadriyyah\'s Github</a> \n                        <a href="https://www.linkedin.com/in/jessica-yuting-wang/"target="_blank" >Jessica\'s LinkedIn</a> \n                        <a href="https://www.linkedin.com/in/darius-hmmond/" target="_blank">Daruis\'s LinkedIn</a> \n                        <a href="https://www.linkedin.com/in/rimma-girsheva" target="_blank">Rimma\'s LinkedIn</a> \n                    </section>\n                </div>\n                <div class="BottomRight">\n                <h3>Special Thanks</h3>\n                    <ul class="aboutus-info">\n                    <li>Carlos Lopez- Lead Coding Instructor </li>\n                    <li>Galvin Hensley- Coding Instructor </li>\n                    <li>Kevin McDonald- Career Advancement Advisor</li>\n                    </ul>\n                <sup><strong>Staff of the WCCI program</strong></sup>\n                </div>   \n        </div>\n    '},se=document.getElementById("app"),de=function(t){re.innerHTML='       \n          \n    <section class="Input">    \n            <div class="Login">\n                <h2>Log in to Tripometer</h2>  \n            </div>\n            <div class="text-danger" id="ErrorMessage"></div>\n            <div id="loginpage">\n                \n                <label class="Username logininfo" for="Username">Username</label>\n                <input type="text" id="Username">\n\n                <label class="Password logininfo" for="Password">Password</label>\n                <input type="password" id="Password">\n            </div>\n            \n            <button id="LoginBtn">Log in</button>\n\n        \n    </section>\n    ',document.getElementById("LoginBtn").addEventListener("click",(function(){console.log("log click");let t=document.getElementById("Username").value,n=document.getElementById("Password").value,i={Username:t,Password:n};""==t||""==n?document.getElementById("ErrorMessage").innerText="Invalid credentials.":e(s+"authenticate",ce,"POST",i)}))},re=document.getElementById("app");function ce(e){if(console.log(e),e.hasOwnProperty("message"))document.getElementById("ErrorMessage").innerText="Your credentials don't match our records.";else{W.setCookie("UserId",e.id,100),W.setCookie("UserName",e.Username,100);let t=q.GetId();q.GetProfile(t),fe.setup()}}const ue=function(){pe.innerHTML=' \n        <section class="Input">      \n        <div class="Login">\n            <h2>Register as a New User</h2>  \n        </div>\n        <div class="text-danger" id="ErrorMessage"></div>\n        <div id="loginpage">\n            \n            <lable class="Username logininfo" for="Username">Username</lable>\n            <input type="text" id="Username">\n\n            <label class="Password logininfo" for="Password">Password</label>\n            <input type="password" id="Password">\n        </div>\n\n        <button id="SubmitBtn">Register</button>\n\n        </section>\n    ',document.getElementById("SubmitBtn").addEventListener("click",(function(){console.log("log register");let t=document.getElementById("Username").value,n=document.getElementById("Password").value,i={Username:t,Password:n};""==t||""==n?document.getElementById("ErrorMessage").innerText="Invalid entries.":e(s+"register",me,"POST",i)}))},pe=document.getElementById("app");function me(e){e.hasOwnProperty("message")?document.getElementById("ErrorMessage").innerText="That username is already taken. Please try a different username.":(console.log(e),q.AddOwnerView(e),fe.setup())}const ge=function(){console.log("Signout"),W.deleteCookie("UserName"),W.deleteCookie("UserId"),ve.Home(),fe.setup()},fe={setup:function(){he.innerHTML=`\n\n\n\n    <h1 class="logo">Tripometer</h1>\n    \n    <section class="nav" style="z-index: 100;">\n            ${q.isLoggedIn()?'<p id="Sign-Out-button">Sign Out</p>\n                    <p id="new-trip-button">New Trip</p>\n                    <p id="my-profile-button">My Profile</p>':'<p id="Register-button">Register</p>\n                    <p id="login-button">Login</p>'}\n            \n            <p id="Aboutus">About Us</p>\n            <p id="Home">Home</p>\n            \n    </section>\n\n\n`;let e=document.getElementById("new-trip-button"),t=document.getElementById("my-profile-button"),n=document.getElementById("Home"),i=document.getElementById("Aboutus"),a=document.getElementById("Register-button"),l=document.getElementById("login-button"),o=document.getElementById("Sign-Out-button");i.addEventListener("click",(function(){console.log("works"),oe()})),n.addEventListener("click",(function(){console.log("works"),ve.Home()})),console.log("CHECK LOGGED IN STATE",q.isLoggedIn()),console.log("LOGIN BUTTON EL",l),q.isLoggedIn()?(console.log("INSIDE IF STATEMENT: TRUE"),o.addEventListener("click",(function(){console.log("works"),q.GetId(),ge()})),e.addEventListener("click",(function(){ie()})),t.addEventListener("click",(function(){let e=q.GetId();q.GetProfile(e)}))):(console.log("INSIDE IF STATEMENT: FALSE"),l.addEventListener("click",(function(){console.log("works"),de()})),a.addEventListener("click",(function(){console.log("works"),ue()})))}},he=(document.getElementById("app"),document.getElementById("header")),ve={setup:function(){fe.setup(),Ee()},Home:Ee},ye=document.getElementById("app");function Ee(){ye.innerHTML='\n    <section class ="hero">\n\n<div class="hero-image">\n<img src="https://selectregistry.com/wp-content/uploads/2019/05/Couple-on-Road-Trip-1800x650.jpg" alt="driving-into-the-sunset" /> \n<div>\n\n\n<div class="hero-text">\n<h2 class="hero-title">We hope this would help plan driving trips from family vacation to busniess trips.</h2>\n <h4 class="pd-lf-50">By predicting how many miles would be driven.</h4>\n <p class="pd-lf-50"> How long it would take and the cost of gas for the trip.</p>\n<div>\n\n</section>\n\n'}ve.setup()})();